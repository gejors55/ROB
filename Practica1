PROGRAM LED
	LABEL 3
		SET OUT[4] = 1
		DELAY 50
		SET OUT[4] = 0
		DELAY 50
		GOTO 3
END

PROGRAM PROG1
	GLOBAL SEMG
	DEFINE SEM1
	LABEL 1
		 PRINTLN "ESPERANDO OBJETO EN EL SENSOR 1"
		 WAIT IN[1] = 1
		 PEND SEM1 FROM SEMG
		 
		 IF IN[1] = 0
		 	SET OUT[1] = 1
		 	PRINTLN "ERROR: NO ESTA EL OBJETO EN EL SENSOR 1"
		 	DELAY 200
		 	SET OUT[1] = 0
		 	GOTO 4
		 ENDIF


		 PRINTLN "COGIENDO PIEZA DE LA POSICION 2"
		 RUN LED
		 SPEED 50
		 MOVED 0
		 SPEED 30
		 MOVED 1
		 OPEN
		 SPEED 10
		 MOVED 2
		 CLOSE

		 IF ENC[6] > -100
			SET OUT[1] = 1
		 	PRINTLN "NO HE PODIDO COGER EL OBJETO EN LA POSICION 2"
		 	DELAY 300
		 	SET OUT[1] = 0
		 	GOTO 4
		 ENDIF

		 SPEED 50
		 MOVED 1
		 PRITNLN "MOVIENDO PIEZA A LA POSICION 3"
		 SPEED 30
		 MOVED 3
		 PRITNLN "SOLTANDO PIEZA EN LA POSICION 4"
		 SPEED 10
		 MOVED 4
		 OPEN

		 PRINTLN "VOLVIENDO A LA POSICION INICIAL"
		 SPEED 50
		 MOVED 3
		 SPEED 50
		 MOVED 0
		 CLOSE
		 POST 1 TO SEMG
	
END

PROGRAM PROG2
	DEFINE SEM2
	LABEL 2
		 PRINTLN "ESPERANDO OBJETO EN EL SENSOR 2"
		 WAIT IN[2] = 1
		 PEND SEM2 FROM SEMG
		 
		 IF IN[2] = 0
		 	SET OUT[2] = 1;
		 	PRINTLN "ERROR: NO ESTA EL OBJETO EN EL SENSOR 2"
		 	DELAY 200
		 	SET OUT[2] = 0
		 	GOTO 4
		 ENDIF

		 PRINTLN "COGIENDO PIEZA DE LA POSICION 7"
		 RUN LED
		 SPEED 50
		 MOVED 0
		 SPEED 30
		 MOVED 6
		 OPEN
		 SPEED 10
		 MOVED 7
		 CLOSE

		 IF ENC[6] > -100
		 	SET OUT[2] = 1
			PRINTLN "NO HE PODIDO COGER EL OBJETO EN LA POSICION 7"
		 	DELAY 300
		 	SET OUT[2] = 0
		 	GOTO 4
		 ENDIF

		 PRINTLN "SOLTANDO PIEZA EN LA POSICION 9"
		 SPEED 50
		 MOVED 6
		 SPEED 30
		 MOVED 8
		 SPEED 10
		 MOVED 9
		 OPEN

		 PRINTLN "VOLVIENDO A LA POSICION INICIAL"
		 SPEED 30
		 MOVED 8
		 SPEED 50
		 MOVED 0
		 CLOSE
		 POST 1 TO SEMG
	
END  

PROGRAM MAIN
	LABEL 4
		SET SEM = 1
		SET OUT[4] = 1
		RUN PROG1
		RUN PROG2
END
